# AstroTracker
Compact and lightweight tracker integrating the Astrocast communication module and u-blox CloudLocate service

### AstroTracker V0.6 REV2

Internal name: MiniTracker

Suitable casing: [Custom casing]()

![bottom](pictures/astrotracker_v06_rev2.jpg)

- U-blox MAX-M8/10 GNSS receiver, **shared antenna** with Astronode S communication module.
- MCU is SAM2121G18A, integrated below the Astronode S module (Astronode S is mounted on a PCB spacer).
- Astronode S + patch antenna communication module.
- Hardware watchdog using [TPL5010](https://www.ti.com/product/TPL5010)
- 2 pin JST connector for wired battery.
- Connectors: USB interface.
- **55x55mm**, 4 layers PCB design.

## Tracker to Operator - Message format

###Protocol V2

#### <code>LOG_PVT_struct</code> Logger PVT message

This structure contains the position, velocity and time (PVT) data generated by the GNSS receiver. 

|Byte offset|Format|Length (Bytes)|Name|Description|
|---|---|---|---|---|
|0|uint8_t|1|slot_tag|Message ID|
|1|uint32|4|Timestamp|Epoch of the measurement in UNIX time|
|5|int32|4|Latitude|Degrees Latitude * 1E7 (i.e., latitude multiplied by 10'000'000)|
|9|int32|4|Longitude|Degrees Longitude * 1E7 (i.e., longitude multiplied by 10'000'000)|
|13|uint8|1|SIV|Number of satellites used in fix|
|14|int32_t|4|gSpeed|Ground speed in mm/s|
|18|uint8|1|V Bat|Voltage of the battery in the tracker (multiplied by 10)|
|19|int8|1|Temperature|Temperature of the tracker in deg C (1 deg resolution)|

#### <code>LOG_RAW_struct</code> Logger RAW message

This structure contains the RAW data that can be uploaded to the CloudLocate service from U-blox to compute the location 
of the tracker. Do not forget to add the timestamp "created date" provided by the satellite communication module.

|Byte offset|Format|Length (Bytes)|Name|Description|
|---|---|---|---|---|
|0|uint8_t|1|slot_tag|Message ID|
|1|uint8_t|20|meas20|U-blox MEAS20 message|

#### <code>LOG_U_MSG_struct</code> Logger user message

This structure contains the text message queued by the user. This message can be directly read on the Astrocast portal.

|Byte offset|Format|Length (Bytes)|Name|Description|
|---|---|---|---|---|
|0|uint8_t|1|slot_tag|Message ID|
|1|uint8_t|40|data|User message data|

#### Message ID

List of message types that are stored in the logger of the tracker.

|Message|ID|
|---|---|
|LOGGER_TAG_PVT_SLOT|0x01|
|LOGGER_TAG_U_MSG_SLOT|0x02|
|LOGGER_TAG_U_CMD_SLOT|0x03|
|LOGGER_TAG_RAW_SLOT|0x04|

## Operator to Tracker - Command format


AstroTracker
Copyright (C) 2023 valcesch

This program is free software; you can redistribute it and/or
modify it under the terms of the GNU Lesser General Public
License as published by the Free Software Foundation; either
version 3 of the License, or (at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
Lesser General Public License for more details.

You should have received a copy of the GNU Lesser General Public License
along with this program; if not, write to the Free Software Foundation,
Inc., 51 Franklin Street, Fifth Floor, Boston, MA  02110-1301, USA.
